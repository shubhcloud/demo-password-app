<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>üîê Password Checker & Generator</title>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<style>
  :root{
    --bg1:#0f2027; --bg2:#203a43; --bg3:#2c5364;
    --accent:#00eaff; --btn:#00c6ff; --copy:#34ffdd;
  }
  html,body{height:100%; margin:0;}
  body{
    font-family: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: linear-gradient(135deg,var(--bg1),var(--bg2),var(--bg3));
    color:#fff; display:flex; align-items:center; justify-content:center; padding:28px;
  }

  .card{
    width:880px; max-width:96%; border-radius:14px; padding:22px;
    background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
    box-shadow: 0 8px 40px rgba(0,0,0,0.55);
    backdrop-filter: blur(8px);
  }

  h1{ margin:2px 0 12px; font-size:22px; letter-spacing:0.2px; }

  .top-controls{ display:flex; gap:12px; margin-bottom:18px; }
  button.primary{
    background:var(--btn); color:#000; border:none; padding:10px 14px; border-radius:10px;
    font-weight:700; cursor:pointer; transition: transform .14s ease, filter .14s ease;
  }
  button.primary:hover{ transform:translateY(-3px); filter:brightness(1.05); }

  .section{ margin-top:6px; padding:14px; border-radius:10px; background:rgba(255,255,255,0.02); }

  .row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
  input[type="password"], input[type="text"], input[type="number"]{
    padding:10px 12px; border-radius:8px; border:none; outline:none; font-size:15px;
    background:rgba(255,255,255,0.03); color:#fff;
  }

  .eye{ cursor:pointer; margin-left:-36px; user-select:none; opacity:0.95; }

  /* Strength meter */
  .meter{ display:flex; gap:10px; margin-top:14px; transition:all .25s ease; }
  .seg{
    flex:1; padding:10px 6px; border-radius:8px; text-align:center; font-weight:700;
    background: rgba(255,255,255,0.06); color:#eaeaea; transform:scale(1);
    transition: all .35s cubic-bezier(.2,.9,.2,1);
  }
  .seg.active{
    background:var(--accent); color:#000; transform:scale(1.07);
    box-shadow: 0 8px 28px rgba(0,236,255,0.12);
  }

  .generated-wrap{ margin-top:14px; display:flex; gap:12px; flex-direction:column; }
  .gen-item{
    width:100%; display:flex; justify-content:space-between; align-items:center;
    padding:10px 12px; border-radius:10px;
    background:linear-gradient(90deg, rgba(0,0,0,0.18), rgba(255,255,255,0.01));
    font-family: monospace; font-size:14px; opacity:0; transform:translateY(8px);
    transition: transform .45s cubic-bezier(.2,.9,.2,1), opacity .45s;
  }
  .gen-item.visible{ opacity:1; transform:none; }

  .copy-btn{
    background:var(--copy); color:#000; border:none; padding:8px 10px;
    border-radius:8px; font-weight:700; cursor:pointer;
  }

  .toast{
    position:fixed; right:20px; top:20px; min-width:220px; max-width:320px;
    padding:10px 14px; border-radius:10px; background:rgba(0,0,0,0.7); color:#fff;
    box-shadow: 0 6px 30px rgba(0,0,0,0.7);
    transform:translateY(-8px); opacity:0; pointer-events:none;
    transition: transform .28s, opacity .28s;
  }
  .toast.show{ transform:none; opacity:1; pointer-events:auto; }
</style>
</head>

<body>
  <div class="card">
    <h1>üîê Password Checker & Generator</h1>

    <div class="top-controls">
      <button id="showCheck" class="primary">Check Password Strength</button>
      <button id="showGen" class="primary">Generate Passwords</button>
    </div>

    <!-- CHECK SECTION -->
    <section id="checkSection" class="section" style="display:none;">
      <div class="row">
        <input id="pwdField" type="password" placeholder="Enter full password (min 12 chars)"
               autocomplete="new-password" autocorrect="off" spellcheck="false" readonly />
        <div class="eye" id="eyeToggle">üëÅÔ∏è</div>
      </div>

      <div class="meter">
        <div id="s1" class="seg">Bad</div>
        <div id="s2" class="seg">Weak</div>
        <div id="s3" class="seg">Strong</div>
        <div id="s4" class="seg">Very Strong</div>
      </div>

      <div style="margin-top:12px;">
        <button id="checkBtn" class="primary">Check Strength</button>
      </div>
    </section>

    <!-- GENERATE SECTION -->
    <section id="genSection" class="section" style="display:none;">
      <div class="row">
        <input id="countField" type="number" min="1" placeholder="How many passwords?" />
        <button id="genBtn" class="primary">Generate</button>
        <button id="copyAll" class="copy-btn" style="display:none;">Copy All</button>
      </div>

      <div id="generatedList" class="generated-wrap"></div>
    </section>
  </div>

  <div id="toast" class="toast"></div>

<script>
/* ---------------------------
   Prevent browser password popup
--------------------------- */
(function fixBrowserPopup(){
  const pwd = document.getElementById("pwdField");
  pwd.name = "x_" + Math.random().toString(36).slice(2);
  pwd.addEventListener("focus",()=>{
    pwd.removeAttribute("readonly");
    pwd.name = "x_" + Math.random().toString(36).slice(2);
  });
})();

/* ---------------------------
   Python logic replicated EXACTLY
--------------------------- */
const UPPER="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split('');
const LOWER="abcdefghijklmnopqrstuvwxyz".split('');
const PUNCT=["!","\"","#","$","%","&","'","(",")","*","+",
",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_","`","{","|","}","~"];
const DIGS=["1","2","3","4","5","6","7","8","9"];

function countChars(a){let m={};a.forEach(c=>m[c]=(m[c]||0)+1);return m;}

function check_password_strength(pwdStr){
  let score=10;
  let password=[...pwdStr];
  let count=countChars(password);

  if(password.length>=12){
    if(password.some(c=>UPPER.includes(c))){
      for(const u of UPPER){ if((count[u]||0)>2){score-=2;break;} }
    } else return "Password should have atleast one upper case.";

    if(password.some(c=>PUNCT.includes(c))){
      for(const p of PUNCT){ if((count[p]||0)>3){score-=2;break;} }
    } else return "Password must have atleast one special character.";

    if(password.some(c=>LOWER.includes(c))){
      for(const l of LOWER){ if((count[l]||0)>2){score-=2;break;} }
    } else return "Password should have atleast one lower case.";

    if(password.some(c=>/\d/.test(c))){
      let nums=password.filter(c=>/\d/.test(c)).map(n=>parseInt(n));
      for(let i=1;i<nums.length;i++){ if(Math.abs(nums[i]-nums[i-1])===1) score-=2;}
	  for (let d = 0; d <= 9; d++) 
	  { 
	   let digit_str = String(d).repeat(3);
       if (pwdStr.includes(digit_str)) { score -= 5;break;}
      }
	  let has_even_series = false;
      let has_odd_series = false;

      let min_series_len = 3;   // minimum length of ‚Äúbad‚Äù sequence (e.g., 2,4,6)

      let even_run = 1;  // current length of even +2 run
      let odd_run = 1;   // current length of odd +2 run

      for (let i = 1; i < nums.length; i++) {
          let diff = nums[i] - nums[i - 1];

          // even +2 series (2,4,6 or 4,6,8 etc.)
          if (nums[i] % 2 === 0 && nums[i - 1] % 2 === 0 && diff === 2) {
              even_run += 1;
          } else {
              even_run = 1;  // reset when pattern breaks
          }

          // odd +2 series (1,3,5 or 3,5,7 etc.)
          if (nums[i] % 2 === 1 && nums[i - 1] % 2 === 1 && diff === 2) {
              odd_run += 1;
          } else {
              odd_run = 1;  // reset when pattern breaks
          }

          // mark when we have a "bad" series anywhere in the list
          if (even_run >= min_series_len) {
              has_even_series = true;
          }
          if (odd_run >= min_series_len) {
              has_odd_series = true;
          }
      }

      // 3Ô∏è‚É£ Apply penalties (still INSIDE the digit block)
      if (has_even_series) {
          score -= 2;  // penalty for any even series
      }

      if (has_odd_series) {
          score -= 2;  // penalty for any odd series
      }

      // extra penalty if both series are present (mixed odd+even series)
      if (has_even_series && has_odd_series) {
          score -= 2;
      }
    } else return "Pasword should have atleast one number";
  } else {
    return "Password should be 12 character long";
  }

  if(score<=2) return "Bad Password !!";
  else if(score<=5) return "Weak Password !!";
  else if(score<=8) return "Strong Password !!";
  else if(score<=10) return "Very Strong Password !!";
}

/* ---------------------------
   UI Logic
--------------------------- */
const s1=document.getElementById("s1");
const s2=document.getElementById("s2");
const s3=document.getElementById("s3");
const s4=document.getElementById("s4");
function resetMeter(){[s1,s2,s3,s4].forEach(x=>x.classList.remove("active"));}

function highlight(level){
  [s1,s2,s3,s4].forEach((el,i)=>{
    el.classList.toggle("active", i===level-1);
  });
}

function toast(msg){
  const t=document.getElementById("toast");
  t.textContent=msg;
  t.classList.add("show");
  setTimeout(()=>t.classList.remove("show"),2800);
}

/* Show/hide sections */
document.getElementById("showCheck").onclick=()=>{
  checkSection.style.display="block";
  genSection.style.display="none";
  resetMeter();
};
document.getElementById("showGen").onclick=()=>{
  genSection.style.display="block";
  checkSection.style.display="none";
};

/* Eye toggle */
document.getElementById("eyeToggle").onclick=()=>{
  const f=document.getElementById("pwdField");
  f.type=f.type==="password"?"text":"password";
};

/* Strength check */
document.getElementById("checkBtn").onclick=()=>{
  const pwd=pwdField.value;
  const result=check_password_strength(pwd);

  if(result.includes("Bad")) highlight(1);
  else if(result.includes("Weak")) highlight(2);
  else if(result.includes("Strong") && !result.includes("Very")) highlight(3);
  else if(result.includes("Very")) highlight(4);
  else resetMeter();

  toast(result);
};

/* ---------------------------
   Generator (Python logic mirrored)
--------------------------- */
function gen_once(){
  const pool=[...UPPER,...LOWER,...PUNCT,...DIGS];
  for(let i=pool.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [pool[i],pool[j]]=[pool[j],pool[i]];
  }
  const take=pool.slice(0,12);
  for(let i=take.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [take[i],take[j]]=[take[j],take[i]];
  }
  return take.join("");
}

document.getElementById("genBtn").onclick=async()=>{
  const val=parseInt(countField.value);
  if(!val||val<1){ toast("Enter valid number"); return; }

  generatedList.innerHTML="";
  generatedSet=new Set();
  copyAll.style.display="none";

  while(generatedSet.size<val){
    let p=gen_once();
    let hasU=[...p].some(c=>/[A-Z]/.test(c));
    let hasL=[...p].some(c=>/[a-z]/.test(c));
    let hasD=[...p].some(c=>/\d/.test(c));
    let hasS=[...p].some(c=>PUNCT.includes(c));
    let unique=!generatedSet.has(p);

    if(hasU&&hasL&&hasD&&hasS&&unique&&p.length===12){
      generatedSet.add(p);
      await new Promise(res=>setTimeout(res,1300));

      const item=document.createElement("div");
      item.className="gen-item";
      item.innerHTML=`<div>${p}</div>
        <button class="copy-btn">Copy</button>`;
      item.querySelector("button").onclick=()=>navigator.clipboard.writeText(p).then(()=>toast("Copied!"));
      generatedList.appendChild(item);
      requestAnimationFrame(()=>item.classList.add("visible"));
    }
  }

  copyAll.style.display="inline-block";
  copyAll.onclick=()=>navigator.clipboard.writeText([...generatedSet].join("\n")).then(()=>toast("All copied!"));

  toast("Generation completed");
};

/* Default View */
document.getElementById("showCheck").click();
</script>

</body>
</html>
